<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Audit Logs</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <style>
        .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    </style>
</head>
<body class="container py-4">

<h2 class="mb-3 text-primary text-center">üìú Audit Logs</h2>

<div class="mb-3 d-flex justify-content-between">
    <a class="btn btn-secondary" th:href="@{/books}">‚Üê V·ªÅ danh s√°ch s√°ch</a>
    <form class="d-flex" method="get" th:action="@{/logs}">
        <label class="me-2">Size:</label>
        <input class="form-control form-control-sm me-2" type="number" name="size"
               th:value="${pageSize}" min="5" max="100" />
        <input type="hidden" name="page" th:value="${currentPage}" />
        <button class="btn btn-sm btn-outline-primary">√Åp d·ª•ng</button>
    </form>
</div>

<table class="table table-striped table-bordered align-middle">
    <thead class="table-dark">
    <tr>
        <th>#</th>
        <th>Th·ªùi gian</th>
        <th>Book ID</th>
        <th>Action</th>
        <th class="text-end">Œî (delta)</th>
        <th>Note</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="log, iStat : ${logs}">
        <td th:text="${iStat.index + 1 + (logs.number * logs.size)}"></td>
        <td class="mono" th:text="${#temporals.format(log.at, 'yyyy-MM-dd HH:mm:ss')}"></td>
        <td th:text="${log.bookId}"></td>
        <td>
      <span th:classappend="${log.action == 'BORROW'} ? 'badge bg-warning text-dark' : 'badge bg-success' "
            th:text="${log.action}"></span>
        </td>
        <td class="text-end fw-bold" th:text="${log.delta}"></td>
        <td class="mono" th:text="${log.note}">-</td>
    </tr>
    <tr th:if="${logs.totalElements == 0}">
        <td colspan="6" class="text-center text-muted">Ch∆∞a c√≥ log n√†o.</td>
    </tr>
    </tbody>
</table>

<!-- Pagination -->
<nav th:if="${logs.totalPages > 1}" aria-label="Pagination">
    <ul class="pagination justify-content-center">
        <li class="page-item" th:classappend="${logs.first} ? 'disabled'">
            <a class="page-link" th:href="@{/logs(page=${logs.number - 1}, size=${logs.size})}">¬´ Tr∆∞·ªõc</a>
        </li>

        <li class="page-item"
            th:each="p : ${#numbers.sequence(0, logs.totalPages - 1)}"
            th:classappend="${p == logs.number} ? 'active'">
            <a class="page-link" th:text="${p + 1}"
               th:href="@{/logs(page=${p}, size=${logs.size})}"></a>
        </li>

        <li class="page-item" th:classappend="${logs.last} ? 'disabled'">
            <a class="page-link" th:href="@{/logs(page=${logs.number + 1}, size=${logs.size})}">Sau ¬ª</a>
        </li>
    </ul>
</nav>

<footer class="mt-4 text-center text-muted">
    <hr>
    <small>L∆∞·ª£t gh√© thƒÉm: <span th:text="${visitorCount}">0</span></small>
</footer>

</body>
</html>
